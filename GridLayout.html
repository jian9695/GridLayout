<!DOCTYPE html>
<html>
<head>
<style>
h2 {
  position: relative;
  left: 10%;
  top: 50%;
}

  table {
    border-collapse: collapse;
  }

  table, td, th {
    border: 1px solid black;
    margin: 0;
    padding: 0;
  }

  td {
    max-width: 100%;
    white-space: nowrap;
  }

.fullscreen {
  border: 2px solid red;
  position: fixed;
  top: 0;
  left: 0;
  bottom: 0;
  right: 0;
  overflow: auto;
  background: lime; /* Just to visualize the extent */
}

  .container {
    position: relative;
    width: 100%;
    height: 0;
    padding-bottom: 56.25%;
  }

  .video {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
  }
</style>
</head>
<body id="Body" onload="onPageLoad()" onresize="onResize()">
  <!--<table>
    <tr>
      <td>
        <button height="20px" type="button" onclick="myFunction()">Try it</button>
      </td>
      <td height="100px">
        <div><img id="News" src="https://ichef.bbci.co.uk/news/660/cpsprodpb/B886/production/_110883274_gettyimages-1025376982-1.jpg"></img></div>
      </td>
    </tr>
  </table>-->
  <!--<div style="height: 100px;width:100px;"><img id="News" src="https://ichef.bbci.co.uk/news/660/cpsprodpb/B886/production/_110883274_gettyimages-1025376982-1.jpg"></img></div>-->
  <!--<table style="width:1000px">
    <tr>
      <th>Firstname</th>
      <th>Lastname</th>
    </tr>
    <tr>
      <td style="max-width:20px;">Peter</td>
      <td><div style="width:100%;height:100%;overflow-x: scroll;"><img id="News" src="https://ichef.bbci.co.uk/news/660/cpsprodpb/B886/production/_110883274_gettyimages-1025376982-1.jpg"></img></div></td>
    </tr>
    <tr>
      <td>Lois</td>
      <td>
        <table style="width:100%;">
          <tr>
            <th>Firstname</th>
            <th>Lastname</th>
          </tr>
          <tr>
            <td>Peter</td>
            <td>Griffin</td>
          </tr>
          <tr>
            <td>Lois</td>
            <td style="max-width:300px;"><div style="width:100%;height:100%;overflow-x: scroll;"><img id="News" src="https://ichef.bbci.co.uk/news/660/cpsprodpb/B886/production/_110883274_gettyimages-1025376982-1.jpg"></img></div></td>
          </tr>
        </table>
      </td>
    </tr>
  </table>-->
<!--   <div id="element_1" cell="0 ,0 ,2 ,1" extent="0.000,0.000,0.667,0.333" 
  style="max-width:100px;overflow-x:auto;border-style: solid;background-color:rgb(255, 255, 128);">
    <img id="News" src="https://ichef.bbci.co.uk/news/660/cpsprodpb/B886/production/_110883274_gettyimages-1025376982-1.jpg">
    </img>
  </div> -->

  <div id="element_0" cell="0,0,1,8" extent="0,0,0.3333333,0.6666667" style="overflow-x:auto;overflow-y:hidden;border-style:solid;background-color:rgb(174,50,79);">
    <p>{X=0,Y=0,Width=0.3333333,Height=0.6666667}
    0 ,0 ,8 ,1 </p>
    </div>
    <div id="element_1" cell="1,0,1,4" extent="0.3333333,0,0.3333333,0.3333333" style="overflow-x:auto;overflow-y:hidden;border-style:solid;background-color:rgb(237,214,54);">
    <p>{X=0.3333333,Y=0,Width=0.3333333,Height=0.3333333}
    0 ,1 ,4 ,1 </p>
    </div>
    <div id="element_2" cell="2,0,1,1" extent="0.6666667,0,0.3333333,0.06666667" style="overflow-x:auto;overflow-y:hidden;border-style:solid;background-color:rgb(0,23,174);">
    <p>{X=0.6666667,Y=0,Width=0.3333333,Height=0.06666667}
    0 ,2 ,1 ,1 </p>
    </div>
    <div id="element_3" cell="2,1,1,1" extent="0.6666667,0.06666667,0.3333333,0.06666667" style="overflow-x:auto;overflow-y:hidden;border-style:solid;background-color:rgb(242,112,119);">
    <p>{X=0.6666667,Y=0.06666667,Width=0.3333333,Height=0.06666667}
    1 ,2 ,1 ,1 </p>
    </div>
    <div id="element_4" cell="2,2,1,1" extent="0.6666667,0.1333333,0.3333333,0.06666667" style="overflow-x:auto;overflow-y:hidden;border-style:solid;background-color:rgb(199,192,116);">
    <p>{X=0.6666667,Y=0.1333333,Width=0.3333333,Height=0.06666667}
    2 ,2 ,1 ,1 </p>
    </div>
    <div id="element_5" cell="2,3,1,3" extent="0.6666667,0.2,0.3333333,0.3" style="overflow-x:auto;overflow-y:hidden;border-style:solid;background-color:rgb(173,248,26);">
    <p>{X=0.6666667,Y=0.2,Width=0.3333333,Height=0.3}
    3 ,2 ,3 ,1 </p>
    </div>
    <div id="element_6" cell="1,4,1,1" extent="0.3333333,0.3333333,0.3333333,0.1111111" style="overflow-x:auto;overflow-y:hidden;border-style:solid;background-color:rgb(85,244,70);">
    <p>{X=0.3333333,Y=0.3333333,Width=0.3333333,Height=0.1111111}
    4 ,1 ,1 ,1 </p>
    </div>
    <div id="element_7" cell="1,5,1,2" extent="0.3333333,0.4444445,0.3333333,0.1111111" style="overflow-x:auto;overflow-y:hidden;border-style:solid;background-color:rgb(1,210,51);">
    <p>{X=0.3333333,Y=0.4444445,Width=0.3333333,Height=0.1111111}
    5 ,1 ,2 ,1 </p>
    </div>
    <div id="element_8" cell="2,6,1,2" extent="0.6666667,0.5,0.3333333,0.1666667" style="overflow-x:auto;overflow-y:hidden;border-style:solid;background-color:rgb(170,14,242);">
    <p>{X=0.6666667,Y=0.5,Width=0.3333333,Height=0.1666667}
    6 ,2 ,2 ,1 </p>
    </div>
    <div id="element_9" cell="1,7,1,1" extent="0.3333333,0.5555556,0.3333333,0.1111111" style="overflow-x:auto;overflow-y:hidden;border-style:solid;background-color:rgb(253,182,30);">
    <p>{X=0.3333333,Y=0.5555556,Width=0.3333333,Height=0.1111111}
    7 ,1 ,1 ,1 </p>
    </div>
    <div id="element_10" cell="0,8,2,1" extent="0,0.6666667,0.6666667,0.1666667" style="overflow-x:auto;overflow-y:hidden;border-style:solid;background-color:rgb(4,104,212);">
    <p>{X=0,Y=0.6666667,Width=0.6666667,Height=0.1666667}
    8 ,0 ,1 ,2 </p>
    </div>
    <div id="element_11" cell="2,8,1,2" extent="0.6666667,0.6666667,0.3333333,0.3333333" style="overflow-x:auto;overflow-y:hidden;border-style:solid;background-color:rgb(72,48,88);">
    <p>{X=0.6666667,Y=0.6666667,Width=0.3333333,Height=0.3333333}
    8 ,2 ,2 ,1 </p>
    </div>
    <div id="element_12" cell="0,9,2,1" extent="0,0.8333334,0.6666667,0.1666667" style="overflow-x:auto;overflow-y:hidden;border-style:solid;background-color:rgb(181,28,87);">
    <p>{X=0,Y=0.8333334,Width=0.6666667,Height=0.1666667}
    9 ,0 ,1 ,2 </p>
    </div>
   
</body>
<script>
  var rowPlacer = null;

  function myFunction() {

  }

  function onPageLoad() {
    onResize();
  }
  
  class GridCell
  {
    column = 0;
    row = 0;
    colSpan = 0;
    rowSpan = 0;

    constructor(column,row,colSpan,rowSpan) {
      this.column = column;
      this.row = row;
      this.colSpan = colSpan;
      this.rowSpan = rowSpan;
    }

    left() { return this.column;}
    right() { return this.column + this.colSpan;}
    top() { return this.row;}
    bottom() { return this.row + this.rowSpan;}

    intersects(gridCell)
    {
      if(gridCell.left() >= this.right() || gridCell.right <= this.left || gridCell.top() >= this.bottom || gridCell.bottom <= this.top()){
        return false;
      }
      return true;
    }

    intersect(gridCell)
    {
      if(this.intersects(gridCell) == false)
         return null;
      var newLeft = Math.min(this.left(), gridCell.left());
      var newRight = Math.min(this.right(), gridCell.right());
      var newTop = Math.min(this.top(), gridCell.top());
      var newBottom = Math.min(this.bottom(), gridCell.bottom());
      return new GridCell(newLeft, newTop, newRight - newLeft, newBottom - newTop);
    }
  }

  class GridElement extends GridCell {
    name = "";
    x = 0;
    y = 0;
    width = 0;
    height = 0;
    contentHeight = 0;
    div = null;
    constructor(name,div,x,y,width,height,column,row,colSpan,rowSpan,contentHeight) {
      super(column,row,colSpan,rowSpan);
      this.name = name;
      this.div = div;
      this.x = x;
      this.y = y;
      this.width = width;
      this.height = height;
      this.contentHeight = contentHeight;
    }
  }

//A class that rearranges the elements horizontally based on their actual content size.
  class ContentDrivenGrid {
  
  elements = null;
  rows = 0;
  columns = 0;
  rowEdgeOffsetsInPercent = null;
  rowEdgeOffsetsInPixel = null;

  constructor(elements, rows, columns, rowEdgeOffsetsInPercent) {
    this.elements = elements;
    this.rows = rows;
    this.columns = columns;
    this.rowEdgeOffsetsInPercent = rowEdgeOffsetsInPercent;
    this.rowEdgeOffsetsInPixel = [];
    for(var i = 0; i < rows + 1; i++){
      this.rowEdgeOffsetsInPixel.push(-1);
    }
    this.gridCells = [];
    for(var row = 0; row < this.rows; row++){
      var gridCellRow = [];
      for(var col = 0; col < this.columns; col++){
        gridCellRow.push(null);
      }
      this.gridCells.push(gridCellRow);
    }
    for(var i = 0; i < this.elements.length; i++){
       var element = this.elements[i];
       this.gridCells[element.row][element.column] = element;
    }

    this.placeElements();
    this.compactVerticalSpace();
  }

  interpolateRows(startEdge, endEdge)
  {
    if(startEdge < 0){startEdge = 0;}
    if(startEdge > this.rows){startEdge = this.rows;}
    if(endEdge < 0){endEdge = 0;}
    if(endEdge > this.rows){endEdge = this.rows;}

    for(var edge = startEdge; edge <= endEdge; edge++){
      var edgeOffset = this.rowEdgeOffsetsInPixel[edge];
      if (edgeOffset > -1){continue;}
      var interpolationStart = edge;
      var interpolationEnd = edge;
      while(interpolationStart >= 0){
           if(this.rowEdgeOffsetsInPixel[interpolationStart] > -1){break;}
           interpolationStart--;
      }
      while(interpolationEnd <= this.rows){
           if(this.rowEdgeOffsetsInPixel[interpolationEnd] > -1){break;}
           interpolationEnd++;
      }

      if(interpolationEnd > this.rows){interpolationEnd = this.rows;}
      //None of the succeeding edges have been set
      //Will fall back to extrapolation
      if(this.rowEdgeOffsetsInPixel[interpolationEnd] <= -1){
         for(var edgeToSet = interpolationStart; edgeToSet < interpolationEnd-1; edgeToSet++){
         this.rowEdgeOffsetsInPixel[edgeToSet+1] = this.extrapolateRowEdge(interpolationStart, edgeToSet + 1, this.rowEdgeOffsetsInPixel[interpolationStart]);
        }
        return;
      }

      var startOffset = this.rowEdgeOffsetsInPixel[interpolationStart];
      var endOffset = this.rowEdgeOffsetsInPixel[interpolationEnd];
      var summedFractions = 0;
      var summedOffset = endOffset-startOffset;
      var fractions = []
      for(var edgeToSet = interpolationStart; edgeToSet < interpolationEnd; edgeToSet++){
        var topEdge = edgeToSet;  
        var bottomEdge = edgeToSet+1;
        var diff = this.rowEdgeOffsetsInPercent[bottomEdge]-this.rowEdgeOffsetsInPercent[topEdge];
        fractions.push(diff);
        summedFractions += diff;
      }

      for(var edgeToSet = interpolationStart; edgeToSet < interpolationEnd-1; edgeToSet++){
        this.rowEdgeOffsetsInPixel[edgeToSet+1] = startOffset + summedOffset * (fractions[edgeToSet-interpolationStart]/summedFractions);
      }
    }
  }

  //Extrapolate the position at targetEdge based on baseEdge and the edge that precedes baseEdge. 
  extrapolateRowEdge(baseEdge, targetEdge, estimatedOffset)
  {
    if(baseEdge < 1 || baseEdge > this.rows){return estimatedOffset;}
    if(targetEdge < 2 || targetEdge > this.rows || targetEdge <= baseEdge){return estimatedOffset;}

    var baseEdgeOffset = this.rowEdgeOffsetsInPixel[baseEdge];
    if (baseEdgeOffset <= -1){return estimatedOffset;}
    var preToBaseEdge = baseEdge - 1;
    while(preToBaseEdge >= 0){
      if(this.rowEdgeOffsetsInPixel[preToBaseEdge] > -1){break;}
      preToBaseEdge--;
    }
    if(preToBaseEdge == baseEdge || this.rowEdgeOffsetsInPixel[preToBaseEdge] <= -1){return estimatedOffset;}

    var summedFractions = this.rowEdgeOffsetsInPercent[baseEdge] - this.rowEdgeOffsetsInPercent[preToBaseEdge];
    var summedOffset = this.rowEdgeOffsetsInPixel[baseEdge] - this.rowEdgeOffsetsInPixel[preToBaseEdge];
    if(summedFractions <= 0 || summedOffset <= 0){return estimatedOffset;}

    var deltaOffset = summedOffset/summedFractions;
    var fraction = this.rowEdgeOffsetsInPercent[targetEdge] - this.rowEdgeOffsetsInPercent[baseEdge];
    if(summedFractions <= 0 || summedOffset <= 0){return estimatedOffset;}

    return this.rowEdgeOffsetsInPixel[baseEdge] + fraction * deltaOffset;
  }

  placeElement(row, col)
  {
    var gridCell = this.gridCells[row][col];
    if (typeof(gridCell) == 'undefined' || gridCell == null){
      return;
    }
    var element = gridCell;
    var topEdge = row;
    var bottomEdge = topEdge + element.rowSpan;

    if(topEdge==0){
      this.rowEdgeOffsetsInPixel[topEdge] = 0;
      this.rowEdgeOffsetsInPixel[bottomEdge] = element.contentHeight;
      return;
    }
    
    var estimatedOffset = this.rowEdgeOffsetsInPixel[topEdge] + element.contentHeight;
    if(estimatedOffset < this.rowEdgeOffsetsInPixel[bottomEdge]){
      estimatedOffset = this.rowEdgeOffsetsInPixel[bottomEdge];
    }else{
      var preEdge = bottomEdge - 1;
      while(preEdge > 0){
         //The estimated offset of the current topEdge is less than that of an preceding topEdge
         //Will extrapolate the offset from the preceding topEdge
         if(this.rowEdgeOffsetsInPixel[preEdge] >= estimatedOffset){
          estimatedOffset = this.extrapolateRowEdge(preEdge, bottomEdge, estimatedOffset);
          break;
         }
         preEdge--;
      }
      this.rowEdgeOffsetsInPixel[bottomEdge] = estimatedOffset;
    }
    
    var edgeToSet = bottomEdge - 1;
    var toInterpolate = false;
    var interpolateStart = topEdge;
    var interpolateEnd = bottomEdge - 1;
    while(edgeToSet >= topEdge){
      if(this.rowEdgeOffsetsInPixel[edgeToSet] >= estimatedOffset){
        this.rowEdgeOffsetsInPixel[edgeToSet] = -1;//reset to be interpolated
        toInterpolate = true;
        interpolateStart = edgeToSet;
      }
      else if (this.rowEdgeOffsetsInPixel[edgeToSet] > -1){
        //The offset of the topEdge is less than that of the preceding topEdge
        //Will interpolate the offset from the preceding topEdge
        if(edgeToSet - 1 > 0 && this.rowEdgeOffsetsInPixel[edgeToSet - 1] > -1 && this.rowEdgeOffsetsInPixel[edgeToSet - 1] > this.rowEdgeOffsetsInPixel[edgeToSet]){
          this.rowEdgeOffsetsInPixel[edgeToSet - 1] = -1;//reset to be interpolated
          toInterpolate = true;
          interpolateStart = edgeToSet;
        }
      }
      edgeToSet--;
    }

    if(toInterpolate == true){
      this.interpolateRows(interpolateStart, interpolateEnd);
    }

    var edgeToSet = bottomEdge + 1;
    var toInterpolate = false;
    var interpolateStart = bottomEdge;
    var interpolateEnd = bottomEdge;
    while(edgeToSet <= this.rows){
      if(this.rowEdgeOffsetsInPixel[edgeToSet] > -1 && this.rowEdgeOffsetsInPixel[edgeToSet] <= estimatedOffset){
        this.rowEdgeOffsetsInPixel[edgeToSet] = -1;//reset to be interpolated
        toInterpolate = true;
        interpolateEnd = edgeToSet;
      }
      else if (this.rowEdgeOffsetsInPixel[edgeToSet] > -1){
      //The offset of a succeeding topEdge is less than that of the current topEdge
      //Will reset and interpolate the topEdge
      if(edgeToSet + 1 <= this.rows && this.rowEdgeOffsetsInPixel[edgeToSet + 1] > -1 && this.rowEdgeOffsetsInPixel[edgeToSet + 1] <= this.rowEdgeOffsetsInPixel[edgeToSet]){
          this.rowEdgeOffsetsInPixel[edgeToSet - 1] = -1;//reset to be interpolated
          toInterpolate = true;
          interpolateStart = edgeToSet;
        }
      }
      edgeToSet++;
    }
    if(toInterpolate == true){
      this.interpolateRows(interpolateStart, interpolateEnd);
    }
  }
  
  placeElements()
  {    
    for(var i = 0; i < this.rowEdgeOffsetsInPixel.length; i++){
      this.rowEdgeOffsetsInPixel[i] = -1;
    }
    for(var row = 0; row < this.rows; row++){
      for(var col = 0; col < this.columns; col++){
        this.placeElement(row, col);
      }
    }
    return this.rowEdgeOffsetsInPixel;
  }

  getElement(row, col)
  {
    var gridCell = this.gridCells[row][col];
    if (typeof(gridCell) == 'undefined' || gridCell == null){
      return null;
    }
    return gridCell;
  }

  compactVerticalSpace()
  {
    var row = 0;
    var rowFlags = []
    for (var row = 0; row < this.rows; row++)
    {
      rowFlags[row] = -1;
    }

    while(row < this.rows) {
      var elementsInRow = [];
      for(var n = 0;n < this.elements.length; n++){
        var elementInRow = this.elements[n];
        if(elementInRow.top() <= row && elementInRow.bottom() >= row){
          elementsInRow.push(elementInRow);
        }
      }
      row++;
      if(elementsInRow.length < 1){continue;}

      var intersectedArea = new GridCell(0, elementsInRow[0].row, 1, elementsInRow[0].rowSpan);
      for(var n = 1; n < elementsInRow.length; n++){
        intersectedArea = intersectedArea.intersect(new GridCell(0, elementsInRow[n].row, 1, elementsInRow[n].rowSpan));
        if(intersectedArea == null){break;}
      }
      //No shared rows to remove.
      if(intersectedArea == null || intersectedArea.rowSpan < 1){continue;}

      var handled = false;
      for(var n = intersectedArea.top(); n < intersectedArea.bottom(); n++){
        if(rowFlags[intersectedArea.top()] > 0){
          handled = true;
          break;
        }
      }

      if(handled == true){
        break;
      }

      var extraSpace = Number.MAX_VALUE;
      for(var n = 0; n < elementsInRow.length; n++){
        var topEdge = elementsInRow[n].top();
        var bottomEdge = elementsInRow[n].bottom();
        var rowSpace = this.rowEdgeOffsetsInPixel[bottomEdge] - this.rowEdgeOffsetsInPixel[topEdge];
        if(extraSpace > rowSpace){
          extraSpace = rowSpace;
        }
      }
      //No empty space left to reduce
      if(extraSpace < 0){continue;}

      var extraSpacePerRow = extraSpace / (intersectedArea.bottom() - intersectedArea.top());
      var reducedSpace = 0;
      for(var n = intersectedArea.top(); n < intersectedArea.bottom(); n++){
        rowFlags[intersectedArea.top()] = 1;
        this.rowEdgeOffsetsInPixel[n + 1] = this.rowEdgeOffsetsInPixel[n + 1] - extraSpacePerRow - reducedSpace;
        reducedSpace+=extraSpacePerRow;
      }

      for(var n = intersectedArea.bottom(); n < this.rowEdgeOffsetsInPixel.length; n++){
        this.rowEdgeOffsetsInPixel[n] = this.rowEdgeOffsetsInPixel[n] - extraSpace;
      }
    }
  }
}

  function onResize(){
    var layoutMargin = 5;
    var clientWidth = window.innerWidth - layoutMargin * 2;
    var clientHeight = window.innerHeight;
    var divs = document.body.getElementsByTagName("div");
    var rowEdgeOffsetsInPercent = ("0,0.06666667,0.1333333,0.2,0.3333334,0.4444445,0.5,0.5555556,0.6666667,0.8333334,1").split(",").map(function(item) {
        return parseFloat(item);
    });
 
    var margin = 5;
    var scrollbarWidth = 25;

    if(rowPlacer == null){
      var elements = [];
      var rows = 0;
      var columns = 0;  
      for(var i = 0; i < divs.length; i++){
         var elementDiv = divs[i];
         if(!elementDiv.id.startsWith("element_")){ continue; }
         var extent = elementDiv.getAttribute("extent").split(",");
         var xPercent=parseFloat(extent[0]);
         var yPercent=parseFloat(extent[1]);
         var wPercent=parseFloat(extent[2]);
         var hPercent=parseFloat(extent[3]);
         var contentHeight = elementDiv.scrollHeight + margin + scrollbarWidth;
         var cell = elementDiv.getAttribute("cell").split(",");
         var col=parseInt(cell[0]);
         var row=parseInt(cell[1]);
         var colSpan=parseInt(cell[2]);
         var rowSpan=parseInt(cell[3]);
         var element = new GridElement(elementDiv.id,elementDiv,xPercent,yPercent,wPercent,hPercent,col,row,colSpan,rowSpan,contentHeight);
         elements.push(element);
         if(rows < row+rowSpan) {rows = row+rowSpan;}
         if(columns < col+colSpan) {columns = col+colSpan;}
       }
       this.rowPlacer = new ContentDrivenGrid(elements, rows, columns, rowEdgeOffsetsInPercent);
    }
  
    for(var i = 0; i < this.rowPlacer.elements.length; i++){
       var element = this.rowPlacer.elements[i];
       var left = clientWidth * element.x + layoutMargin;
       var top = this.rowPlacer.rowEdgeOffsetsInPixel[element.row] + layoutMargin;
       var bottom = this.rowPlacer.rowEdgeOffsetsInPixel[element.row+element.rowSpan] + layoutMargin;
       var width = clientWidth * element.width - margin;
       var height = bottom - top;
       height = height - margin;
       
       element.div.style.maxWidth = width.toString() + "px";
       element.div.style.width = width.toString() + "px";
       element.div.style.minWidth = width.toString() + "px";
       element.div.style.maxHeight = height.toString() + "px";
       element.div.style.height = height.toString() + "px";
       element.div.style.minHeight = height.toString() + "px";
       element.div.style.left = left.toString() + "px";
       element.div.style.top = top.toString() + "px";
       element.div.style.position = "absolute";
    }
  };
</script>
</html>